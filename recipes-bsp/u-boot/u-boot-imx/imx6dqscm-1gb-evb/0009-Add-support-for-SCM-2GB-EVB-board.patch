From 475e4ad109dfd24396aae54808b15de57891e714 Mon Sep 17 00:00:00 2001
From: Alejandro Sierra <b18039@freescale.com>
Date: Fri, 11 Dec 2015 09:41:04 -0600
Subject: [PATCH 09/29] Add support for SCM 2GB EVB board

Add support for SCM 2GB EVB board

Signed-off-by: Alejandro Sierra <b18039@freescale.com>
---
 .../freescale/mx6dqscmqwks/imximage_scm_lpddr2.cfg | 346 +++++++++++----------
 configs/mx6dqscm_2gb_interleaving_evb_defconfig    |   5 +
 .../mx6dqscm_2gb_interleaving_evb_spinor_defconfig |   7 +
 3 files changed, 194 insertions(+), 164 deletions(-)
 create mode 100644 configs/mx6dqscm_2gb_interleaving_evb_defconfig
 create mode 100644 configs/mx6dqscm_2gb_interleaving_evb_spinor_defconfig

diff --git a/board/freescale/mx6dqscmqwks/imximage_scm_lpddr2.cfg b/board/freescale/mx6dqscmqwks/imximage_scm_lpddr2.cfg
index a707a45..33ae79d 100644
--- a/board/freescale/mx6dqscmqwks/imximage_scm_lpddr2.cfg
+++ b/board/freescale/mx6dqscmqwks/imximage_scm_lpddr2.cfg
@@ -45,179 +45,197 @@ CSF 0x2000
  *	value	  value to be stored in the register
  */
 #ifdef CONFIG_SCM_LPDDR2_2GB
-/* DCD */
 /* DDR clock to 400MHz */
-DATA 4, 0x020C4018, 0x00060324
-		
-DATA 4,	0x020e0798, 0x00080000
-DATA 4,	0x020e0758, 0x00000000
-		
-DATA 4,	0x020e0588, 0x00000028
-DATA 4,	0x020e0594, 0x00000028
-		
-DATA 4,	0x020e056c, 0x00000028
-DATA 4,	0x020e0578, 0x00000028
-DATA 4,	0x020e074c, 0x00000028
-		
-DATA 4,	0x020e057c, 0x00000028
-DATA 4,	0x020e058c, 0x00000008
-DATA 4,	0x020e059c, 0x00000028
-DATA 4,	0x020e05a0, 0x00000028
-DATA 4,	0x020e078c, 0x00000028
-		
-DATA 4,	0x020e0750, 0x00020000
-DATA 4,	0x020e05a8, 0x00003028
-DATA 4,	0x020e05b0, 0x00003028
-DATA 4,	0x020e0524, 0x00003028
-DATA 4,	0x020e051c, 0x00003028
-DATA 4,	0x020e0518, 0x00003028
-DATA 4,	0x020e050c, 0x00003028
-DATA 4,	0x020e05b8, 0x00003028
-DATA 4,	0x020e05c0, 0x00003028
-		
-DATA 4,	0x020e0774, 0x00020000
-DATA 4,	0x020e0784, 0x00000028
-DATA 4,	0x020e0788, 0x00000028
-DATA 4,	0x020e0794, 0x00000028
-DATA 4,	0x020e079c, 0x00000028
-DATA 4,	0x020e07a0, 0x00000028
-DATA 4,	0x020e07a4, 0x00000028
-DATA 4,	0x020e07a8, 0x00000028
-DATA 4,	0x020e0748, 0x00000028
-		
-DATA 4,	0x020e05ac, 0x00000028
-DATA 4,	0x020e05b4, 0x00000028
-DATA 4,	0x020e0528, 0x00000028
-DATA 4,	0x020e0520, 0x00000028
-DATA 4,	0x020e0514, 0x00000028
-DATA 4,	0x020e0510, 0x00000028
-DATA 4,	0x020e05bc, 0x00000028
-DATA 4,	0x020e05c4, 0x00000028
-		
-DATA 4,	0x021b001c, 0x00008000
-DATA 4,	0x021b401c, 0x00008000
-		
-DATA 4,	0x021b085c, 0x1B4700C7
-DATA 4,	0x021b485c, 0x1B4700C7
-		
-DATA 4,	0x021b0800, 0xA1390003
-		
-DATA 4,	0x021b0890, 0x00400000
-DATA 4,	0x021b4890, 0x00400000
-		
-DATA 4,	0x021b0848, 0x40404040
-DATA 4,	0x021b4848, 0x40404040
-		
-DATA 4,	0x021b0850, 0x40404040
-DATA 4,	0x021b4850, 0x40404040
-
-DATA 4,	0x021b083c, 0x20000000
-DATA 4,	0x021b0840, 0x00000000
-DATA 4,	0x021b483c, 0x20000000
-DATA 4,	0x021b4840, 0x00000000
-		
-DATA 4,	0x021b081c, 0x33333333
-DATA 4,	0x021b0820, 0x33333333
-DATA 4,	0x021b0824, 0x33333333
-DATA 4,	0x021b0828, 0x33333333
-DATA 4,	0x021b481c, 0x33333333
-DATA 4,	0x021b4820, 0x33333333
-DATA 4,	0x021b4824, 0x33333333
-DATA 4,	0x021b4828, 0x33333333
-
-DATA 4,	0x021b082c, 0xF3333333
-DATA 4,	0x021b0830, 0xF3333333
-DATA 4,	0x021b0834, 0xF3333333
-DATA 4,	0x021b0838, 0xF3333333
-DATA 4,	0x021b482c, 0xF3333333
-DATA 4,	0x021b4830, 0xF3333333
-DATA 4,	0x021b4834, 0xF3333333
-DATA 4,	0x021b4838, 0xF3333333
-		
-DATA 4,	0x021b08b8, 0x00000800
-DATA 4,	0x021b48b8, 0x00000800
-		
-DATA 4,	0x021b0004, 0x00020036
-DATA 4,	0x021b0008, 0x00000000
-DATA 4,	0x021b000c, 0x33374133
-DATA 4,	0x021b0010, 0x00100A82
-DATA 4,	0x021b0014, 0x00000093
-		
-DATA 4,	0x021b0018, 0x0000174C
-DATA 4,	0x021b001c, 0x00008000
-DATA 4,	0x021b002c, 0x0F9F26D2
-DATA 4,	0x021b0030, 0x00000010
-DATA 4,	0x021b0038, 0x00190778
+DATA 4, 0x020C4018 0x00060324
+/* AHB_ROOT_CLK change divide ratio from 4 to 3 for ENET */
+DATA 4, 0x020C4014 0x00018900
+
+DATA 4, 0x020e0798, 0x00080000
+DATA 4, 0x020e0758, 0x00000000
+
+DATA 4, 0x020E0588, 0x00000020
+DATA 4, 0x020E0594, 0x00000020
+
+DATA 4, 0x020E056c, 0x00000020
+DATA 4, 0x020E0578, 0x00000020
+DATA 4, 0x020E074c, 0x00000020
+
+DATA 4, 0x020E057c, 0x00000020
+DATA 4, 0x020E058c, 0x00000000
+DATA 4, 0x020E059c, 0x00000020
+DATA 4, 0x020E05a0, 0x00000020
+DATA 4, 0x020E078c, 0x00000020
+
+DATA 4, 0x020E0750, 0x00020000
+DATA 4, 0x020E05a8, 0x00003020
+DATA 4, 0x020E05b0, 0x00003020
+DATA 4, 0x020E0524, 0x00003020
+DATA 4, 0x020E051c, 0x00003020
+DATA 4, 0x020E0518, 0x00003020
+DATA 4, 0x020E050c, 0x00003020
+DATA 4, 0x020E05b8, 0x00003020
+DATA 4, 0x020E05c0, 0x00003020
+
+DATA 4, 0x020E0774, 0x00020000
+
+DATA 4, 0x020E0784, 0x00000020
+DATA 4, 0x020E0788, 0x00000020
+DATA 4, 0x020E0794, 0x00000020
+DATA 4, 0x020E079c, 0x00000020
+DATA 4, 0x020E07a0, 0x00000020
+DATA 4, 0x020E07a4, 0x00000020
+DATA 4, 0x020E07a8, 0x00000020
+DATA 4, 0x020E0748, 0x00000020
+
+DATA 4, 0x020E05ac, 0x00000020
+DATA 4, 0x020E05b4, 0x00000020
+DATA 4, 0x020E0528, 0x00000020
+DATA 4, 0x020E0520, 0x00000020
+DATA 4, 0x020E0514, 0x00000020
+DATA 4, 0x020E0510, 0x00000020
+DATA 4, 0x020E05bc, 0x00000020
+DATA 4, 0x020E05c4, 0x00000020
+
+DATA 4, 0x020E0590, 0x00000020
+DATA 4, 0x020E0598, 0x00000020
+
+DATA 4, 0x021b001c, 0x00008000
+DATA 4, 0x021b401c, 0x00008000
+
+DATA 4, 0x021b085c, 0x1b4700c7
+DATA 4, 0x021b485c, 0x1b4700c7
+
+DATA 4, 0x021b0800, 0xa1390003
+
+DATA 4, 0x021b0890, 0x00400000
+DATA 4, 0x021b4890, 0x00400000
+
+DATA 4, 0x021b0848, 0x44404044
+DATA 4, 0x021b4848, 0x44443A46
+
+DATA 4, 0x021b0850, 0x34343A38
+DATA 4, 0x021b4850, 0x3E2E483C
+
+DATA 4, 0x021b083c, 0x20000000
+DATA 4, 0x021b0840, 0x00000000
+DATA 4, 0x021b483c, 0x20000000
+DATA 4, 0x021b4840, 0x00000000
+
+DATA 4, 0x021b081c, 0x33333333
+DATA 4, 0x021b0820, 0x33333333
+DATA 4, 0x021b0824, 0x33333333
+DATA 4, 0x021b0828, 0x33333333
+DATA 4, 0x021b481c, 0x33333333
+DATA 4, 0x021b4820, 0x33333333
+DATA 4, 0x021b4824, 0x33333333
+DATA 4, 0x021b4828, 0x33333333
+DATA 4, 0x021b082c, 0xf3333333
+DATA 4, 0x021b0830, 0xf3333333
+DATA 4, 0x021b0834, 0xf3333333
+DATA 4, 0x021b0838, 0xf3333333
+DATA 4, 0x021b482c, 0xf3333333
+DATA 4, 0x021b4830, 0xf3333333
+DATA 4, 0x021b4834, 0xf3333333
+DATA 4, 0x021b4838, 0xf3333333
+
+DATA 4, 0x021b08b8, 0x00000800
+DATA 4, 0x021b48b8, 0x00000800
+
+DATA 4, 0x021b0004, 0x00020036
+DATA 4, 0x021b0008, 0x00000000
+DATA 4, 0x021b000c, 0x33374133
+
+DATA 4, 0x021b0010, 0x00100a82
+
+DATA 4, 0x021b0014, 0x00000093
+
+DATA 4, 0x021b0018, 0x0000174C
+DATA 4, 0x021b001c, 0x00008000
+DATA 4, 0x021b002c, 0x0f9f26d2
+DATA 4, 0x021b0030, 0x00000010
+DATA 4, 0x021b0038, 0x00190778
+
 #ifdef CONFIG_INTERLEAVING_MODE
-DATA 4, 0x021b0040, 0x00000053
+DATA 4, 0x021b0040, 0x00000063
 #else
 DATA 4, 0x021b0040, 0x0000004f
 #endif
 
-DATA 4,	0x021b0400, 0x11420000
-DATA 4,	0x021b0000, 0xc3110000
-		
-DATA 4,	0x021b4004, 0x00020036
-DATA 4,	0x021b4008, 0x00000000
-DATA 4,	0x021b400c, 0x33374133
-DATA 4,	0x021b4010, 0x00100A82
-DATA 4,	0x021b4014, 0x00000093
-		
-DATA 4,	0x021b4018, 0x0000174C
-DATA 4,	0x021b401c, 0x00008000
-DATA 4,	0x021b402c, 0x0F9F26D2
-DATA 4,	0x021b4030, 0x00000010
-DATA 4,	0x021b4038, 0x00190778
+DATA 4, 0x021b0400, 0x11420000
+DATA 4, 0x021b0000, 0xc3110000
+
+DATA 4, 0x021b4004, 0x00020036
+DATA 4, 0x021b4008, 0x00000000
+
+DATA 4, 0x021b400c, 0x33374133
+
+DATA 4, 0x021b4010, 0x00100a82
+
+DATA 4, 0x021b4014, 0x00000093
+
+DATA 4, 0x021b4018, 0x0000174C
+DATA 4, 0x021b401c, 0x00008000
+
+DATA 4, 0x021b402c, 0x0f9f26d2
+
+DATA 4, 0x021b4030, 0x00000010
+
+DATA 4, 0x021b4038, 0x00190778
+
 #ifdef CONFIG_INTERLEAVING_MODE
-DATA 4, 0x021b4040, 0x00000013
+DATA 4, 0x021b4040, 0x00000023
 #else
 DATA 4, 0x021b4040, 0x00000017
 #endif
 
-DATA 4,	0x021b4400, 0x11420000
-DATA 4,	0x021b4000, 0xc3110000
-		
-DATA 4,	0x021b001c, 0x003F8030
-DATA 4,	0x021b001c, 0xFF0A8030
-DATA 4,	0x021b001c, 0x82018030
-DATA 4,	0x021b001c, 0x04028030
-DATA 4,	0x021b001c, 0x04038030
-
-DATA 4,	0x021b001c, 0x003F8038
-DATA 4,	0x021b001c, 0xFF0A8038
-DATA 4,	0x021b001c, 0x82018038
-DATA 4,	0x021b001c, 0x04028038
-DATA 4,	0x021b001c, 0x04038038
-		
-DATA 4,	0x021b401c, 0x003F8030
-DATA 4,	0x021b401c, 0xFF0A8030
-DATA 4,	0x021b401c, 0x82018030
-DATA 4,	0x021b401c, 0x04028030
-DATA 4,	0x021b401c, 0x04038030
-
-DATA 4,	0x021b401c, 0x003F8038
-DATA 4,	0x021b401c, 0xFF0A8038
-DATA 4,	0x021b401c, 0x82018038
-DATA 4,	0x021b401c, 0x04028038
-DATA 4,	0x021b401c, 0x04038038
-		
-DATA 4,	0x021b0800, 0xA1390003
-		
-DATA 4,	0x021b0020, 0x00001800
-DATA 4,	0x021b4020, 0x00001800
-		
-DATA 4,	0x021b0818, 0x00000000
-DATA 4,	0x021b4818, 0x00000000
-		
-DATA 4,	0x021b0004, 0x00025576
-DATA 4,	0x021b4004, 0x00025576
-		
-DATA 4,	0x021b0404, 0x00011006
-DATA 4,	0x021b4404, 0x00011006
-		
-DATA 4,	0x021b001c, 0x00000000
-DATA 4,	0x021b401c, 0x00000000
-	
+DATA 4, 0x021b4400, 0x11420000
+DATA 4, 0x021b4000, 0xc3110000
+
+/* Channel 0 */
+/* CS0 */
+DATA 4, 0x021b001c, 0x003f8030
+DATA 4, 0x021b001c, 0xff0a8030
+DATA 4, 0x021b001c, 0x82018030
+DATA 4, 0x021b001c, 0x04028030
+DATA 4, 0x021b001c, 0x04038030
+/* CS1 */
+DATA 4, 0x021b001c, 0x003f8038
+DATA 4, 0x021b001c, 0xff0a8038
+DATA 4, 0x021b001c, 0x82018038
+DATA 4, 0x021b001c, 0x04028038
+DATA 4, 0x021b001c, 0x04038038
+
+/* Channel 1 */
+/* CS0 */
+DATA 4, 0x021b401c, 0x003f8030
+DATA 4, 0x021b401c, 0xff0a8030
+DATA 4, 0x021b401c, 0x82018030
+DATA 4, 0x021b401c, 0x04028030
+DATA 4, 0x021b401c, 0x04038030
+/* CS1 */
+DATA 4, 0x021b401c, 0x003f8038
+DATA 4, 0x021b401c, 0xff0a8038
+DATA 4, 0x021b401c, 0x82018038
+DATA 4, 0x021b401c, 0x04028038
+DATA 4, 0x021b401c, 0x04038038
+
+DATA 4, 0x021b0800, 0xa1390003
+
+DATA 4, 0x021b0020, 0x00001800
+DATA 4, 0x021b4020, 0x00001800
+
+DATA 4, 0x021b0818, 0x00000000
+DATA 4, 0x021b4818, 0x00000000
+
+DATA 4, 0x021b0004, 0x00025576
+DATA 4, 0x021b4004, 0x00025576
+
+DATA 4, 0x021b0404, 0x00011006
+DATA 4, 0x021b4404, 0x00011006
+
+DATA 4, 0x021b001c, 0x00000000
+DATA 4, 0x021b401c, 0x00000000
+
 /* enable clocks */
 DATA 4, 0x020c4068, 0x00C03F3F
 DATA 4, 0x020c406c, 0x0030FC03
@@ -235,9 +253,9 @@ DATA 4, 0x020e001c, 0x007F007F
 #else
 /* DCD */
 /* DDR clock to 400MHz */
-DATA 4, 0x020C4018 0x00060324
+DATA 4, 0x020C4018 0x00060324 
 /* AHB_ROOT_CLK change divide ratio from 4 to 3 for ENET */
-/* DATA 4, 0x020C4014 0x00018900 */
+DATA 4, 0x020C4014 0x00018900 
 
 /* DSE to 80 ohms, 100K PD on DQS */
 DATA 4 0x020e0798 0x00080000
diff --git a/configs/mx6dqscm_2gb_interleaving_evb_defconfig b/configs/mx6dqscm_2gb_interleaving_evb_defconfig
new file mode 100644
index 0000000..3635db4
--- /dev/null
+++ b/configs/mx6dqscm_2gb_interleaving_evb_defconfig
@@ -0,0 +1,5 @@
+CONFIG_SYS_EXTRA_OPTIONS="IMX_CONFIG=board/freescale/mx6dqscmqwks/imximage_scm_lpddr2.cfg,MX6Q,DDR_MB=2048,SYS_USE_SPINOR,DEFAULT_FDT_FILE=\"imx6dqscm-2gb-evb-ldo.dtb\",INTERLEAVING_MODE,SCMEVB,SCM_LPDDR2_2GB"
+CONFIG_ARM=y
+CONFIG_TARGET_MX6DQSCMQWKS=y
+CONFIG_DM=y
+CONFIG_DM_THERMAL=y
diff --git a/configs/mx6dqscm_2gb_interleaving_evb_spinor_defconfig b/configs/mx6dqscm_2gb_interleaving_evb_spinor_defconfig
new file mode 100644
index 0000000..74ac50e
--- /dev/null
+++ b/configs/mx6dqscm_2gb_interleaving_evb_spinor_defconfig
@@ -0,0 +1,7 @@
+CONFIG_SYS_EXTRA_OPTIONS="IMX_CONFIG=board/freescale/mx6dqscmqwks/imximage_scm_lpddr2.cfg,MX6Q,DDR_MB=2048,SYS_BOOT_SPINOR,DEFAULT_FDT_FILE=\"imx6dqscm-2gb-evb-ldo.dtb\",INTERLEAVING_MODE,SCMEVB,SCM_LPDDR2_2GB"
+CONFIG_ARM=y
+CONFIG_TARGET_MX6DQSCMQWKS=y
+CONFIG_SYS_MALLOC_F=y
+CONFIG_SYS_MALLOC_F_LEN=0x400
+CONFIG_DM=y
+CONFIG_DM_THERMAL=y
-- 
2.7.4

